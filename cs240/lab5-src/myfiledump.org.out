0x0000000000000000: 0A 23 69 6E 63 6C 75 64 65 20 3C 73 74 64 69 6F  .#include <stdio
0x0000000000000010: 2E 68 3E 0A 23 69 6E 63 6C 75 64 65 20 3C 73 74  .h>.#include <st
0x0000000000000020: 72 69 6E 67 2E 68 3E 0A 23 69 6E 63 6C 75 64 65  ring.h>.#include
0x0000000000000030: 20 3C 73 74 64 6C 69 62 2E 68 3E 0A 0A 76 6F 69   <stdlib.h>..voi
0x0000000000000040: 64 20 66 69 6C 65 64 75 6D 70 28 63 68 61 72 20  d filedump(char 
0x0000000000000050: 2A 20 70 20 2C 20 69 6E 74 20 6C 65 6E 29 20 7B  * p , int len) {
0x0000000000000060: 0A 20 20 20 20 69 6E 74 20 69 3B 0A 20 20 20 20  .    int i;.    
0x0000000000000070: 69 6E 74 20 6A 3D 30 3B 0A 20 20 20 20 69 6E 74  int j=0;.    int
0x0000000000000080: 20 63 3B 0A 20 20 20 20 69 6E 74 20 78 3B 0A 20   c;.    int x;. 
0x0000000000000090: 20 20 20 69 66 20 28 6C 65 6E 20 25 20 31 36 20     if (len % 16 
0x00000000000000A0: 3D 3D 20 30 29 20 7B 0A 20 20 20 20 20 20 20 20  == 0) {.        
0x00000000000000B0: 20 20 20 20 78 20 3D 20 28 6C 65 6E 2F 31 36 29      x = (len/16)
0x00000000000000C0: 20 2D 20 31 3B 0A 20 20 20 20 7D 20 65 6C 73 65   - 1;.    } else
0x00000000000000D0: 20 7B 0A 20 20 20 20 20 20 20 20 20 20 20 20 78   {.            x
0x00000000000000E0: 20 3D 20 28 6C 65 6E 2F 31 36 29 3B 0A 20 20 20   = (len/16);.   
0x00000000000000F0: 20 7D 0A 0A 20 20 20 20 69 6E 74 20 7A 3D 30 3B   }..    int z=0;
0x0000000000000100: 0A 0A 20 20 20 20 77 68 69 6C 65 28 6A 20 3C 3D  ..    while(j <=
0x0000000000000110: 20 78 29 20 7B 0A 0A 20 20 20 20 20 20 20 20 20   x) {..         
0x0000000000000120: 20 20 20 70 72 69 6E 74 66 28 22 30 78 25 30 31     printf("0x%01
0x0000000000000130: 36 6C 58 3A 20 22 2C 20 28 75 6E 73 69 67 6E 65  6lX: ", (unsigne
0x0000000000000140: 64 20 6C 6F 6E 67 29 20 28 7A 3C 3C 34 29 29 3B  d long) (z<<4));
0x0000000000000150: 20 2F 2F 20 50 72 69 6E 74 20 61 64 64 72 65 73   // Print addres
0x0000000000000160: 73 20 6F 66 20 74 68 65 20 62 65 67 69 6E 6E 69  s of the beginni
0x0000000000000170: 6E 67 20 6F 66 20 70 2E 20 59 6F 75 20 6E 65 65  ng of p. You nee
0x0000000000000180: 64 20 74 6F 20 70 72 69 6E 74 20 69 74 20 65 76  d to print it ev
0x0000000000000190: 65 72 79 20 31 36 20 62 79 74 65 73 0A 20 20 20  ery 16 bytes.   
0x00000000000001A0: 20 20 20 20 20 20 20 20 20 69 66 28 6A 20 3D 3D           if(j ==
0x00000000000001B0: 20 78 20 26 26 20 28 6C 65 6E 25 31 36 29 20 21   x && (len%16) !
0x00000000000001C0: 3D 20 30 29 20 7B 0A 20 20 20 20 20 20 20 20 20  = 0) {.         
0x00000000000001D0: 20 20 20 20 20 20 20 20 20 20 20 69 6E 74 20 6C             int l
0x00000000000001E0: 61 73 74 20 3D 20 6C 65 6E 20 25 20 31 36 3B 0A  ast = len % 16;.
0x00000000000001F0: 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20                  
0x0000000000000200: 20 20 20 20 66 6F 72 20 28 69 6E 74 20 6B 3D 30      for (int k=0
0x0000000000000210: 3B 20 6B 3C 6C 61 73 74 3B 20 6B 2B 2B 29 20 7B  ; k<last; k++) {
0x0000000000000220: 0A 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20  .               
0x0000000000000230: 20 20 20 20 20 20 20 20 20 20 20 20 20 63 20 3D               c =
0x0000000000000240: 20 70 5B 6B 20 2B 20 28 31 36 2A 6A 29 5D 26 30   p[k + (16*j)]&0
0x0000000000000250: 78 46 46 3B 0A 20 20 20 20 20 20 20 20 20 20 20  xFF;.           
0x0000000000000260: 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20                  
0x0000000000000270: 20 70 72 69 6E 74 66 28 22 25 30 32 58 20 22 2C   printf("%02X ",
0x0000000000000280: 20 63 29 3B 0A 20 20 20 20 20 20 20 20 20 20 20   c);.           
0x0000000000000290: 20 20 20 20 20 20 20 20 20 7D 0A 20 20 20 20 20           }.     
0x00000000000002A0: 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 66                 f
0x00000000000002B0: 6F 72 28 69 6E 74 20 6C 3D 30 3B 20 6C 3C 28 31  or(int l=0; l<(1
0x00000000000002C0: 36 20 2D 20 6C 61 73 74 29 3B 20 6C 2B 2B 29 20  6 - last); l++) 
0x00000000000002D0: 7B 0A 20 20 20 20 20 20 20 20 20 20 20 20 20 20  {.              
0x00000000000002E0: 20 20 20 20 20 20 20 20 20 20 20 20 20 20 70 72                pr
0x00000000000002F0: 69 6E 74 66 28 22 20 20 20 22 29 3B 0A 20 20 20  intf("   ");.   
0x0000000000000300: 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20                  
0x0000000000000310: 20 7D 0A 20 20 20 20 20 20 20 20 20 20 20 20 20   }.             
0x0000000000000320: 20 20 20 20 20 20 20 70 72 69 6E 74 66 28 22 20         printf(" 
0x0000000000000330: 22 29 3B 0A 20 20 20 20 20 20 20 20 20 20 20 20  ");.            
0x0000000000000340: 20 20 20 20 20 20 20 20 66 6F 72 20 28 69 3D 30          for (i=0
0x0000000000000350: 3B 20 69 20 3C 20 6C 61 73 74 3B 20 69 2B 2B 29  ; i < last; i++)
0x0000000000000360: 20 7B 0A 20 20 20 20 20 20 20 20 20 20 20 20 20   {.             
0x0000000000000370: 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 63                 c
0x0000000000000380: 20 3D 20 70 5B 69 20 2B 20 28 31 36 2A 6A 29 5D   = p[i + (16*j)]
0x0000000000000390: 26 30 78 46 46 3B 0A 20 20 20 20 20 20 20 20 20  &0xFF;.         
0x00000000000003A0: 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20                  
0x00000000000003B0: 20 20 20 70 72 69 6E 74 66 28 22 25 63 22 2C 20     printf("%c", 
0x00000000000003C0: 28 63 3E 3D 33 32 20 26 26 20 63 3C 31 32 37 29  (c>=32 && c<127)
0x00000000000003D0: 3F 63 3A 27 2E 27 29 3B 0A 20 20 20 20 20 20 20  ?c:'.');.       
0x00000000000003E0: 20 20 20 20 20 20 20 20 20 20 20 20 20 7D 0A 0A               }..
0x00000000000003F0: 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20                  
0x0000000000000400: 20 20 20 20 70 72 69 6E 74 66 28 22 5C 6E 22 29      printf("\n")
0x0000000000000410: 3B 0A 0A 20 20 20 20 20 20 20 20 20 20 20 20 7D  ;..            }
0x0000000000000420: 20 65 6C 73 65 20 69 66 28 6A 20 21 3D 20 78 20   else if(j != x 
0x0000000000000430: 7C 7C 20 28 6C 65 6E 25 31 36 29 20 3D 3D 20 30  || (len%16) == 0
0x0000000000000440: 29 20 7B 0A 20 20 20 20 20 20 20 20 20 20 20 20  ) {.            
0x0000000000000450: 20 20 20 20 20 66 6F 72 20 28 69 3D 30 3B 20 69       for (i=0; i
0x0000000000000460: 20 3C 20 31 36 3B 20 69 2B 2B 29 20 7B 0A 20 20   < 16; i++) {.  
0x0000000000000470: 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20                  
0x0000000000000480: 20 20 20 20 20 20 20 20 20 20 63 20 3D 20 70 5B            c = p[
0x0000000000000490: 69 2B 28 6A 2A 31 36 29 5D 26 30 78 46 46 3B 20  i+(j*16)]&0xFF; 
0x00000000000004A0: 2F 2F 20 47 65 74 20 76 61 6C 75 65 20 61 74 20  // Get value at 
0x00000000000004B0: 5B 70 5D 2E 20 54 68 65 20 26 30 78 46 46 20 69  [p]. The &0xFF i
0x00000000000004C0: 73 20 74 6F 20 6D 61 6B 65 20 73 75 72 65 20 79  s to make sure y
0x00000000000004D0: 6F 75 20 74 72 75 6E 63 61 74 65 20 74 6F 20 38  ou truncate to 8
0x00000000000004E0: 62 69 74 73 20 6F 72 20 6F 6E 65 20 62 79 74 65  bits or one byte
0x00000000000004F0: 2E 0A 0A 20 20 20 20 20 20 20 20 20 20 20 20 20  ...             
0x0000000000000500: 20 20 20 20 20 20 20 20 20 20 20 20 2F 2F 20 50              // P
0x0000000000000510: 72 69 6E 74 20 66 69 72 73 74 20 62 79 74 65 20  rint first byte 
0x0000000000000520: 61 73 20 68 65 78 61 64 65 63 69 6D 61 6C 0A 20  as hexadecimal. 
0x0000000000000530: 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20                  
0x0000000000000540: 20 20 20 20 20 20 20 20 70 72 69 6E 74 66 28 22          printf("
0x0000000000000550: 25 30 32 58 20 22 2C 20 63 29 3B 0A 20 20 20 20  %02X ", c);.    
0x0000000000000560: 20 20 20 20 20 20 20 20 20 20 20 20 20 7D 0A 20               }. 
0x0000000000000570: 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20                  
0x0000000000000580: 70 72 69 6E 74 66 28 22 20 22 29 3B 0A 20 20 20  printf(" ");.   
0x0000000000000590: 20 20 20 20 20 20 20 20 20 20 20 20 20 20 66 6F                fo
0x00000000000005A0: 72 20 28 69 3D 30 3B 20 69 20 3C 20 31 36 3B 20  r (i=0; i < 16; 
0x00000000000005B0: 69 2B 2B 29 20 7B 0A 20 20 20 20 20 20 20 20 20  i++) {.         
0x00000000000005C0: 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20                  
0x00000000000005D0: 20 20 20 63 20 3D 20 70 5B 69 20 2B 20 28 31 36     c = p[i + (16
0x00000000000005E0: 2A 6A 29 5D 26 30 78 46 46 3B 0A 20 20 20 20 20  *j)]&0xFF;.     
0x00000000000005F0: 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20                  
0x0000000000000600: 20 20 20 20 20 20 20 70 72 69 6E 74 66 28 22 25         printf("%
0x0000000000000610: 63 22 2C 20 28 63 3E 3D 33 32 20 26 26 20 63 3C  c", (c>=32 && c<
0x0000000000000620: 31 32 37 29 3F 63 3A 27 2E 27 29 3B 0A 20 20 20  127)?c:'.');.   
0x0000000000000630: 20 20 20 20 20 20 20 20 20 20 20 20 20 20 7D 0A                }.
0x0000000000000640: 0A 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20  .               
0x0000000000000650: 20 20 70 72 69 6E 74 66 28 22 5C 6E 22 29 3B 0A    printf("\n");.
0x0000000000000660: 20 20 20 20 20 20 20 20 20 20 20 20 7D 0A 09 20              }.. 
0x0000000000000670: 20 20 20 6A 2B 2B 3B 0A 09 20 20 20 20 7A 2B 2B     j++;..    z++
0x0000000000000680: 3B 0A 20 20 20 20 7D 0A 0A 7D 0A 0A 69 6E 74 0A  ;.    }..}..int.
0x0000000000000690: 6D 61 69 6E 28 69 6E 74 20 61 72 67 63 2C 20 63  main(int argc, c
0x00000000000006A0: 68 61 72 20 2A 2A 61 72 67 76 29 20 7B 0A 09 46  har **argv) {..F
0x00000000000006B0: 49 4C 45 2A 66 64 20 3D 20 66 6F 70 65 6E 28 61  ILE*fd = fopen(a
0x00000000000006C0: 72 67 76 5B 31 5D 2C 20 22 72 22 29 3B 0A 09 69  rgv[1], "r");..i
0x00000000000006D0: 66 20 28 66 64 20 3D 3D 4E 55 4C 4C 29 20 7B 0A  f (fd ==NULL) {.
0x00000000000006E0: 09 09 70 72 69 6E 74 66 28 22 45 72 72 6F 72 20  ..printf("Error 
0x00000000000006F0: 6F 70 65 6E 69 6E 67 20 66 69 6C 65 20 5C 22 69  opening file \"i
0x0000000000000700: 6E 76 61 6C 69 64 66 69 6C 65 5C 22 5C 6E 22 29  nvalidfile\"\n")
0x0000000000000710: 3B 0A 09 09 65 78 69 74 28 31 29 3B 0A 09 7D 0A  ;...exit(1);..}.
0x0000000000000720: 09 66 73 65 65 6B 28 66 64 2C 20 30 4C 2C 20 53  .fseek(fd, 0L, S
0x0000000000000730: 45 45 4B 5F 45 4E 44 29 3B 20 20 2F 2F 20 47 6F  EEK_END);  // Go
0x0000000000000740: 20 74 6F 20 74 68 65 20 65 6E 64 20 6F 66 20 74   to the end of t
0x0000000000000750: 68 65 20 66 69 6C 65 20 66 69 6E 0A 20 20 20 20  he file fin.    
0x0000000000000760: 20 20 20 20 69 6E 74 20 66 69 6C 65 53 69 7A 65      int fileSize
0x0000000000000770: 20 3D 20 66 74 65 6C 6C 28 66 64 29 3B 20 2F 2F   = ftell(fd); //
0x0000000000000780: 20 47 65 74 20 63 75 72 72 65 6E 74 20 66 69 6C   Get current fil
0x0000000000000790: 65 20 70 6F 69 6E 74 65 72 0A 20 20 20 20 20 20  e pointer.      
0x00000000000007A0: 20 20 66 73 65 65 6B 28 66 64 2C 20 30 4C 2C 20    fseek(fd, 0L, 
0x00000000000007B0: 53 45 45 4B 5F 53 45 54 29 3B 20 2F 2F 20 47 6F  SEEK_SET); // Go
0x00000000000007C0: 20 62 61 63 6B 20 74 6F 20 74 68 65 20 62 65 67   back to the beg
0x00000000000007D0: 69 6E 6E 69 6E 67 20 6F 66 20 74 68 65 20 66 69  inning of the fi
0x00000000000007E0: 6C 65 0A 09 69 66 28 61 72 67 63 20 3D 3D 20 33  le..if(argc == 3
0x00000000000007F0: 20 26 26 20 61 74 6F 69 28 61 72 67 76 5B 32 5D   && atoi(argv[2]
0x0000000000000800: 29 20 3C 20 66 69 6C 65 53 69 7A 65 29 20 7B 0A  ) < fileSize) {.
0x0000000000000810: 09 09 66 69 6C 65 53 69 7A 65 20 3D 20 61 74 6F  ..fileSize = ato
0x0000000000000820: 69 28 61 72 67 76 5B 32 5D 29 3B 0A 09 7D 0A 0A  i(argv[2]);..}..
0x0000000000000830: 09 63 68 61 72 20 61 72 72 61 79 5B 66 69 6C 65  .char array[file
0x0000000000000840: 53 69 7A 65 2B 31 5D 3B 0A 09 66 72 65 61 64 28  Size+1];..fread(
0x0000000000000850: 61 72 72 61 79 2C 20 31 2C 20 66 69 6C 65 53 69  array, 1, fileSi
0x0000000000000860: 7A 65 2C 20 66 64 29 3B 0A 09 66 69 6C 65 64 75  ze, fd);..filedu
0x0000000000000870: 6D 70 28 61 72 72 61 79 2C 20 66 69 6C 65 53 69  mp(array, fileSi
0x0000000000000880: 7A 65 29 3B 0A 0A 0A 7D 0A 0A 0A                 ze);...}...
